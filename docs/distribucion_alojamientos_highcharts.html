<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Distribución de alojamientos certificados</title>
    <style>
      :root {
        color-scheme: light;
        --bg-color: #f7f9fb;
        --card-bg: #ffffff;
        --text-color: #0f172a;
        --muted-text: #475569;
        --shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
      }

      body {
        font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
        margin: 0;
        padding: 1.25rem 0 1.5rem;
        background: var(--bg-color);
        color: var(--text-color);
      }

      .chart-shell {
        max-width: 960px;
        margin: 0 auto;
        background: var(--card-bg);
        border-radius: 16px;
        padding: 1rem 1.5rem 1.5rem;
        box-shadow: var(--shadow);
      }

      #container {
        height: 500px;
      }
    </style>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
  </head>
  <body>
    <div class="chart-shell">
      <div id="container"></div>
    </div>
    <script>
      const categories = [
        "Cabañas",
        "Hostal",
        "Hotel",
        "Cama y desayuno / alojamiento familiar",
        "Departamentos Turísticos y/o Ejecutivos",
        "Residencial",
        "Albergue / refugio",
        "Apartotel",
        "Centro de turismo de naturaleza o ecoalbergue",
        "Hostería",
        "Hotel boutique",
        "Complejo turístico o centro vacacional",
        "Estancia o Hacienda"
      ];

      const values = [
        2680,
        1853,
        1574,
        722,
        629,
        510,
        305,
        281,
        235,
        193,
        163,
        124,
        21
      ];

      const shares = [
        0.2665,
        0.1843,
        0.1565,
        0.0718,
        0.0626,
        0.0507,
        0.0303,
        0.0279,
        0.0234,
        0.0192,
        0.0162,
        0.0123,
        0.0021
      ];

      const chartTheme = {
        chartBg: "rgba(255,255,255,0)",
        text: "#0f172a",
        muted: "#475569",
        grid: "#dbeafe",
        tooltipBg: "#ffffff",
        tooltipText: "#0f172a",
        accent: "#2563eb",
        palette: [
          "#2563eb",
          "#0ea5e9",
          "#22d3ee",
          "#14b8a6",
          "#f97316",
          "#facc15",
          "#a855f7",
          "#6366f1",
          "#fb7185",
          "#34d399",
          "#94a3b8",
          "#f43f5e",
          "#1d4ed8"
        ]
      };

      const positionExportButton = (chart) => {
        if (!chart || !chart.exportSVGElements || !chart.exportSVGElements[0]) {
          return;
        }
        const button = chart.exportSVGElements[0];
        const bbox = button.getBBox();
        const targetX = chart.chartWidth - bbox.width - 12;
        const targetY = 8;
        button.translate(targetX - button.x, targetY - button.y);
      };

      const buildChartOptions = (theme) => ({
        chart: {
          type: "column",
          backgroundColor: theme.chartBg,
          spacingRight: 24,
          style: {
            fontFamily: "Inter, Helvetica Neue, Arial, sans-serif"
          },
          events: {
            load: function () {
              positionExportButton(this);
            },
            render: function () {
              positionExportButton(this);
            }
          }
        },
        title: { text: null },
        subtitle: { text: null },
        xAxis: {
          categories,
          title: {
            text: "Tipo de alojamiento",
            style: { color: theme.text }
          },
          labels: {
            style: {
              fontSize: "12px",
              color: theme.muted
            }
          },
          lineColor: theme.grid,
          tickColor: theme.grid,
          crosshair: { color: theme.accent }
        },
        yAxis: {
          min: 0,
          gridLineColor: theme.grid,
          labels: {
            style: { color: theme.muted }
          },
          title: {
            text: "Empresas certificadas",
            style: { color: theme.text }
          }
        },
        tooltip: {
          backgroundColor: theme.tooltipBg,
          style: { color: theme.tooltipText },
          borderRadius: 8,
          formatter: function () {
            const pct = (shares[this.point.index] * 100).toFixed(1);
            return `<strong>${this.key}</strong><br/>Empresas certificadas: ${Highcharts.numberFormat(
              this.y,
              0,
              ",",
              "."
            )}<br/>Participación: ${pct}%`;
          }
        },
        plotOptions: {
          column: {
            pointPadding: 0.15,
            borderRadius: 4,
            colorByPoint: true
          }
        },
        colors: theme.palette,
        series: [
          {
            name: "Empresas certificadas",
            data: values,
            dataLabels: {
              enabled: true,
              format: "{point.y:,.0f}",
              style: {
                fontSize: "11px",
                fontWeight: "600",
                color: theme.text
              }
            }
          }
        ],
        credits: {
          text: "UACh CER · Equipo de Ciencia de Datos",
          href: null,
          style: { color: theme.muted }
        },
        exporting: {
          enabled: true,
          buttons: {
            contextButton: {
              symbolStroke: "#475569",
              align: "right",
              verticalAlign: "top",
              x: -10,
              y: 8
            }
          }
        },
        exportData: {
          tableCaption: "Datos exportados"
        }
      });

      window.addEventListener("DOMContentLoaded", () => {
        Highcharts.chart("container", buildChartOptions(chartTheme));
      });
    </script>
  </body>
</html>
